# Comparing `tmp/torch_model_archiver-0.7.1-py3-none-any.whl.zip` & `tmp/torch_model_archiver-0.8.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,18 @@
-Zip file size: 14459 bytes, number of entries: 16
--rw-r--r--  2.0 unx      182 b- defN 23-Feb-08 21:58 model_archiver/__init__.py
--rw-r--r--  2.0 unx     5008 b- defN 23-Feb-08 21:58 model_archiver/arg_parser.py
--rw-r--r--  2.0 unx      188 b- defN 23-Feb-08 21:58 model_archiver/model_archiver_error.py
--rw-r--r--  2.0 unx     2176 b- defN 23-Feb-08 21:58 model_archiver/model_packaging.py
--rw-r--r--  2.0 unx    11128 b- defN 23-Feb-08 21:58 model_archiver/model_packaging_utils.py
--rw-r--r--  2.0 unx      225 b- defN 23-Feb-08 21:58 model_archiver/version.py
--rw-r--r--  2.0 unx        6 b- defN 23-Feb-08 21:58 model_archiver/version.txt
--rw-r--r--  2.0 unx        0 b- defN 23-Feb-08 21:58 model_archiver/manifest_components/__init__.py
--rw-r--r--  2.0 unx     1192 b- defN 23-Feb-08 21:58 model_archiver/manifest_components/manifest.py
--rw-r--r--  2.0 unx     1998 b- defN 23-Feb-08 21:58 model_archiver/manifest_components/model.py
--rw-r--r--  2.0 unx    11357 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/LICENSE
--rw-r--r--  2.0 unx     1347 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       95 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       15 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1472 b- defN 23-Feb-08 22:01 torch_model_archiver-0.7.1.dist-info/RECORD
-16 files, 36481 bytes uncompressed, 11967 bytes compressed:  67.2%
+Zip file size: 14608 bytes, number of entries: 16
+-rw-r--r--  2.0 unx      182 b- defN 23-May-11 18:09 model_archiver/__init__.py
+-rw-r--r--  2.0 unx     5484 b- defN 23-May-11 18:09 model_archiver/arg_parser.py
+-rw-r--r--  2.0 unx      188 b- defN 23-May-11 18:09 model_archiver/model_archiver_error.py
+-rw-r--r--  2.0 unx     2251 b- defN 23-May-11 18:09 model_archiver/model_packaging.py
+-rw-r--r--  2.0 unx    11488 b- defN 23-May-11 18:09 model_archiver/model_packaging_utils.py
+-rw-r--r--  2.0 unx      225 b- defN 23-May-11 18:09 model_archiver/version.py
+-rw-r--r--  2.0 unx        6 b- defN 23-May-11 18:09 model_archiver/version.txt
+-rw-r--r--  2.0 unx        0 b- defN 23-May-11 18:09 model_archiver/manifest_components/__init__.py
+-rw-r--r--  2.0 unx     1190 b- defN 23-May-11 18:09 model_archiver/manifest_components/manifest.py
+-rw-r--r--  2.0 unx     1958 b- defN 23-May-11 18:09 model_archiver/manifest_components/model.py
+-rw-r--r--  2.0 unx    11357 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1347 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       95 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       15 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1472 b- defN 23-May-11 18:14 torch_model_archiver-0.8.0.dist-info/RECORD
+16 files, 37350 bytes uncompressed, 12116 bytes compressed:  67.6%
```

## zipnote {}

```diff
@@ -24,26 +24,26 @@
 
 Filename: model_archiver/manifest_components/manifest.py
 Comment: 
 
 Filename: model_archiver/manifest_components/model.py
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/LICENSE
+Filename: torch_model_archiver-0.8.0.dist-info/LICENSE
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/METADATA
+Filename: torch_model_archiver-0.8.0.dist-info/METADATA
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/WHEEL
+Filename: torch_model_archiver-0.8.0.dist-info/WHEEL
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/entry_points.txt
+Filename: torch_model_archiver-0.8.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/top_level.txt
+Filename: torch_model_archiver-0.8.0.dist-info/top_level.txt
 Comment: 
 
-Filename: torch_model_archiver-0.7.1.dist-info/RECORD
+Filename: torch_model_archiver-0.8.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## model_archiver/arg_parser.py

```diff
@@ -13,15 +13,14 @@
 
     """
     Argument parser for torch-model-archiver commands
     """
 
     @staticmethod
     def export_model_args_parser():
-
         """Argument parser for torch-model-export"""
 
         parser_export = argparse.ArgumentParser(
             prog="torch-model-archiver",
             description="Torch Model Archiver Tool",
             formatter_class=argparse.RawTextHelpFormatter,
         )
@@ -50,15 +49,15 @@
             "--model-file",
             required=False,
             type=str,
             default=None,
             help="Path to python file containing model architecture.\n"
             "This parameter is mandatory for eager mode models.\n"
             "The model architecture file must contain only one\n"
-            "class definition extended from torch.nn.modules.",
+            "class definition extended from torch.nn.Module.",
         )
 
         parser_export.add_argument(
             "--handler",
             required=True,
             dest="handler",
             type=str,
@@ -96,23 +95,26 @@
         )
 
         parser_export.add_argument(
             "--archive-format",
             required=False,
             type=str,
             default="default",
-            choices=["tgz", "no-archive", "default"],
+            choices=["tgz", "no-archive", "zip-store", "default"],
             help="The format in which the model artifacts are archived.\n"
             '"tgz": This creates the model-archive in <model-name>.tar.gz format.\n'
             'If platform hosting TorchServe requires model-artifacts to be in ".tar.gz"\n'
             "use this option.\n"
             '"no-archive": This option creates an non-archived version of model artifacts\n'
             'at "export-path/{model-name}" location. As a result of this choice, \n'
             'MANIFEST file will be created at "export-path/{model-name}" location\n'
             "without archiving these model files\n"
+            '"zip-store": This creates the model-archive in <model-name>.mar format\n'
+            "but will skip deflating the files to speed up creation. Mainly used\n"
+            "for testing purposes\n"
             '"default": This creates the model-archive in <model-name>.mar format.\n'
             "This is the default archiving format. Models archived in this format\n"
             "will be readily hostable on native TorchServe.\n",
         )
 
         parser_export.add_argument(
             "-f",
@@ -139,8 +141,17 @@
             required=False,
             type=str,
             default=None,
             help="Path to a requirements.txt containing model specific python dependency\n"
             " packages.",
         )
 
+        parser_export.add_argument(
+            "-c",
+            "--config-file",
+            required=False,
+            type=str,
+            default=None,
+            help="Path to a yaml file containing model configuration eg. batch_size.",
+        )
+
         return parser_export
```

## model_archiver/model_packaging.py

```diff
@@ -18,14 +18,15 @@
     model_file = args.model_file
     serialized_file = args.serialized_file
     model_name = args.model_name
     handler = args.handler
     extra_files = args.extra_files
     export_file_path = args.export_path
     requirements_file = args.requirements_file
+    config_file = args.config_file
 
     try:
         ModelExportUtils.validate_inputs(model_name, export_file_path)
         # Step 1 : Check if .mar already exists with the given model name
         export_file_path = ModelExportUtils.check_mar_already_exists(
             model_name, export_file_path, args.force, args.archive_format
         )
@@ -33,14 +34,15 @@
         # Step 2 : Copy all artifacts to temp directory
         artifact_files = {
             "model_file": model_file,
             "serialized_file": serialized_file,
             "handler": handler,
             "extra_files": extra_files,
             "requirements-file": requirements_file,
+            "config_file": config_file,
         }
 
         model_path = ModelExportUtils.copy_artifacts(model_name, **artifact_files)
 
         # Step 2 : Zip 'em all up
         ModelExportUtils.archive(
             export_file_path, model_name, model_path, manifest, args.archive_format
```

## model_archiver/model_packaging_utils.py

```diff
@@ -1,25 +1,31 @@
 """
 Helper utils for Model Export tool
 """
 
+import glob
 import logging
 import os
 import re
 import shutil
 import tarfile
 import tempfile
 import zipfile
 from io import BytesIO
 
 from .manifest_components.manifest import Manifest
 from .manifest_components.model import Model
 from .model_archiver_error import ModelArchiverError
 
-archiving_options = {"tgz": ".tar.gz", "no-archive": "", "default": ".mar"}
+archiving_options = {
+    "tgz": ".tar.gz",
+    "no-archive": "",
+    "zip-store": ".mar",
+    "default": ".mar",
+}
 
 
 model_handlers = {
     "base_handler": "anything",
     "text_classifier": "text",
     "image_classifier": "vision",
     "object_detector": "vision",
@@ -103,14 +109,15 @@
         model = Model(
             model_name=modelargs.model_name,
             serialized_file=modelargs.serialized_file,
             model_file=modelargs.model_file,
             handler=modelargs.handler,
             model_version=modelargs.version,
             requirements_file=modelargs.requirements_file,
+            config_file=modelargs.config_file,
         )
         return model
 
     @staticmethod
     def generate_manifest_json(args):
         """
         Function to generate manifest as a json string from the inputs provided by the user in the command line
@@ -152,28 +159,28 @@
                     if path in model_handlers.keys():
                         continue
 
                     if ".py" not in path:
                         path = (path.split(":")[0] if ":" in path else path) + ".py"
 
                 if file_type == "extra_files":
-                    for file in path.split(","):
-                        file = file.strip()
-                        if os.path.isfile(file):
-                            shutil.copy2(file, model_path)
-                        elif os.path.isdir(file) and file != model_path:
-                            for item in os.listdir(file):
-                                src = os.path.join(file, item)
-                                dst = os.path.join(model_path, item)
-                                if os.path.isfile(src):
-                                    shutil.copy2(src, dst)
-                                elif os.path.isdir(src):
-                                    shutil.copytree(src, dst, False, None)
-                        else:
-                            raise ValueError(f"Invalid extra file given {file}")
+                    for path_or_wildcard in path.split(","):
+                        for file in glob.glob(path_or_wildcard.strip()):
+                            if os.path.isfile(file):
+                                shutil.copy2(file, model_path)
+                            elif os.path.isdir(file) and file != model_path:
+                                for item in os.listdir(file):
+                                    src = os.path.join(file, item)
+                                    dst = os.path.join(model_path, item)
+                                    if os.path.isfile(src):
+                                        shutil.copy2(src, dst)
+                                    elif os.path.isdir(src):
+                                        shutil.copytree(src, dst, False, None)
+                            else:
+                                raise ValueError(f"Invalid extra file given {file}")
                 else:
                     shutil.copy(path, model_path)
 
         return model_path
 
     @staticmethod
     def archive(
@@ -212,15 +219,20 @@
                     )
                 # Write the MANIFEST in place
                 manifest_path = os.path.join(mar_path, MAR_INF)
                 ModelExportUtils.make_dir(manifest_path)
                 with open(os.path.join(manifest_path, MANIFEST_FILE_NAME), "w") as f:
                     f.write(manifest)
             else:
-                with zipfile.ZipFile(mar_path, "w", zipfile.ZIP_DEFLATED) as z:
+                zip_mode = (
+                    zipfile.ZIP_STORED
+                    if archive_format == "zip-store"
+                    else zipfile.ZIP_DEFLATED
+                )
+                with zipfile.ZipFile(mar_path, "w", zip_mode) as z:
                     ModelExportUtils.archive_dir(
                         model_path, z, archive_format, model_name
                     )
                     # Write the manifest here now as a json
                     z.writestr(os.path.join(MAR_INF, MANIFEST_FILE_NAME), manifest)
         except IOError:
             logging.error(
@@ -231,15 +243,14 @@
             raise
         except:
             logging.error("Failed to convert %s to the model-archive.", model_name)
             raise
 
     @staticmethod
     def archive_dir(path, dst, archive_format, model_name):
-
         """
         This method zips the dir and filters out some files based on a expression
         :param archive_format:
         :param path:
         :param dst:
         :param model_name:
         :return:
```

## model_archiver/version.txt

```diff
@@ -1 +1 @@
-0.7.1
+0.8.0
```

## model_archiver/manifest_components/manifest.py

```diff
@@ -4,26 +4,24 @@
 from datetime import datetime
 from enum import Enum
 
 from model_archiver import __version__
 
 
 class RuntimeType(Enum):
-
     PYTHON = "python"
     PYTHON3 = "python3"
 
 
 class Manifest(object):
     """
     The main manifest object which gets written into the model archive as MANIFEST.json
     """
 
     def __init__(self, runtime, model):
-
         self.creation_time = datetime.now().strftime("%d/%m/%Y %H:%M:%S")
         self.runtime = RuntimeType(runtime)
         self.model = model
         self.archiver_version = __version__
         self.manifest_dict = self.__to_dict__()
 
     def __to_dict__(self):
```

## model_archiver/manifest_components/model.py

```diff
@@ -1,60 +1,67 @@
 # pylint: disable=missing-docstring
 import json
-import sys
+import os
 
 
 class Model(object):
     """
     Model is a part of the manifest.json. It defines the properties of the model such as name, version as weill
     as the entry point into the service code through the handler property
     """
 
-    def __init__(self, model_name, serialized_file, handler, model_file=None, model_version=None,
-                 extensions=None, requirements_file=None):
-
+    def __init__(
+        self,
+        model_name,
+        serialized_file,
+        handler,
+        model_file=None,
+        model_version=None,
+        extensions=None,
+        requirements_file=None,
+        config_file=None,
+    ):
         self.model_name = model_name
         self.serialized_file = None
         if serialized_file:
-            if sys.platform.startswith('win32') and serialized_file.find("\\") != -1:
-                self.serialized_file = serialized_file.split("\\")[-1]
-            else:
-                self.serialized_file = serialized_file.split("/")[-1]
+            self.serialized_file = os.path.basename(serialized_file)
         self.model_file = model_file
         self.model_version = model_version
         self.extensions = extensions
-        if sys.platform.startswith('win32') and handler.find("\\") != -1:
-            self.handler = handler.split("\\")[-1]
-        else:
-            self.handler = handler.split("/")[-1]
+        self.handler = os.path.basename(handler)
         self.requirements_file = requirements_file
-
+        self.config_file = None
+        if config_file:
+            self.config_file = os.path.basename(config_file)
         self.model_dict = self.__to_dict__()
 
     def __to_dict__(self):
-        model_dict = dict()
+        model_dict = {}
 
-        model_dict['modelName'] = self.model_name
+        model_dict["modelName"] = self.model_name
 
         if self.serialized_file:
-            model_dict['serializedFile'] = self.serialized_file
+            model_dict["serializedFile"] = self.serialized_file
 
-        model_dict['handler'] = self.handler
+        model_dict["handler"] = self.handler
 
         if self.model_file:
-            model_dict['modelFile'] = self.model_file.split("/")[-1]
+            model_dict["modelFile"] = self.model_file.split("/")[-1]
 
         if self.model_version:
-            model_dict['modelVersion'] = self.model_version
+            model_dict["modelVersion"] = self.model_version
 
         if self.extensions:
-            model_dict['extensions'] = self.extensions
+            model_dict["extensions"] = self.extensions
 
         if self.requirements_file:
-            model_dict['requirementsFile'] = self.requirements_file.split("/")[-1]
+            model_dict["requirementsFile"] = self.requirements_file.split("/")[-1]
+
+        if self.config_file:
+            model_dict["configFile"] = self.config_file
 
         return model_dict
 
     def __str__(self):
         return json.dumps(self.model_dict)
 
     def __repr__(self):
```

## Comparing `torch_model_archiver-0.7.1.dist-info/LICENSE` & `torch_model_archiver-0.8.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `torch_model_archiver-0.7.1.dist-info/METADATA` & `torch_model_archiver-0.8.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: torch-model-archiver
-Version: 0.7.1
+Version: 0.8.0
 Summary: Torch Model Archiver is used for creating archives of trained neural net models that can be consumed by TorchServe inference
 Home-page: https://github.com/pytorch/serve/model-archiver/
 Author: PyTorch Serving team
 Author-email: noreply@noreply.com
 License: Apache License Version 2.0
 Keywords: TorchServe Torch Model Archive Archiver Server Serving Deep Learning Inference AI
 License-File: LICENSE
```

## Comparing `torch_model_archiver-0.7.1.dist-info/RECORD` & `torch_model_archiver-0.8.0.dist-info/RECORD`

 * *Files 18% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 model_archiver/__init__.py,sha256=CHGrnw4GMivQyzNf-_5v7oj8d1CsBU_fMIH9ddsr7Qw,182
-model_archiver/arg_parser.py,sha256=PyMViU32QxRx-MR2ExSfOu13VAyUVoxmytakDEl4mJM,5008
+model_archiver/arg_parser.py,sha256=9YNP8svIJz4bVlzbZqxJKVIo18uBWrUy2qC9J2HBBNM,5484
 model_archiver/model_archiver_error.py,sha256=XMrfQUfbUGPXRTBlv3avyhUYN0xdWckOzDQ8Uzeqi60,188
-model_archiver/model_packaging.py,sha256=dgKIXdS-Empg9AGiTmWSZNK5ggxPhlyazjK8KEPZPe4,2176
-model_archiver/model_packaging_utils.py,sha256=bTPJ0Ke7Q0xd_SlLIpYimFrELpVHS3YAIa0lIClBx48,11128
+model_archiver/model_packaging.py,sha256=jtH7aPPcJLkQl-GgzlMhzOV25j-I3aCqrNjI3R-W8oU,2251
+model_archiver/model_packaging_utils.py,sha256=wuB4LsPD0mVymaQs5GzA_VU1tzkNoEu9oYdsAaPbsa4,11488
 model_archiver/version.py,sha256=_ykzDr2EZBc4jE4VrHbqPiOWl9V3N2ViHHQwvjIhX8s,225
-model_archiver/version.txt,sha256=kCMRx7s4-hZY_0A972FY7nN4_p1uLihPocOHNcMb0ws,6
+model_archiver/version.txt,sha256=pmeA2iMQO-rxJDK0GFCJZrMaKjp4f5RopbbNqoZnwe8,6
 model_archiver/manifest_components/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-model_archiver/manifest_components/manifest.py,sha256=MVDW9DA-IhkPdayPAWCBkdYTEtWGR0C4TBb9-K7MKig,1192
-model_archiver/manifest_components/model.py,sha256=OwrFMWeo_baYa-ZBhYTIBUn_YLg52fkWAYwDueWWy_Y,1998
-torch_model_archiver-0.7.1.dist-info/LICENSE,sha256=tAkwu8-AdEyGxGoSvJ2gVmQdcicWw3j1ZZueVV74M-E,11357
-torch_model_archiver-0.7.1.dist-info/METADATA,sha256=L2GAnRP03-HaEJpEXIPXioEFb6JauHHhML0HAyKZuYI,1347
-torch_model_archiver-0.7.1.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-torch_model_archiver-0.7.1.dist-info/entry_points.txt,sha256=13CA71XcVPE8XObqXDMD11N1rvYv4QIXTx1s9Rhx_Nw,95
-torch_model_archiver-0.7.1.dist-info/top_level.txt,sha256=ikmVS_zMdngq-9j2YdJ_YXmw_THpyb5eH3KiDYYYXZk,15
-torch_model_archiver-0.7.1.dist-info/RECORD,,
+model_archiver/manifest_components/manifest.py,sha256=-VyqkGIu6gnZPK2B64Rpa2uIG1OjlGuUVpMXLt6Cing,1190
+model_archiver/manifest_components/model.py,sha256=1aQKBJfoeJbIUpv_4qFKNvlYRMmtwuWflinqxB0qFKY,1958
+torch_model_archiver-0.8.0.dist-info/LICENSE,sha256=tAkwu8-AdEyGxGoSvJ2gVmQdcicWw3j1ZZueVV74M-E,11357
+torch_model_archiver-0.8.0.dist-info/METADATA,sha256=I2YUG2CykkYixI-JeMzYHOLawFiRBt0pWtyjHDUKO0c,1347
+torch_model_archiver-0.8.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+torch_model_archiver-0.8.0.dist-info/entry_points.txt,sha256=13CA71XcVPE8XObqXDMD11N1rvYv4QIXTx1s9Rhx_Nw,95
+torch_model_archiver-0.8.0.dist-info/top_level.txt,sha256=ikmVS_zMdngq-9j2YdJ_YXmw_THpyb5eH3KiDYYYXZk,15
+torch_model_archiver-0.8.0.dist-info/RECORD,,
```

