# Comparing `tmp/pice_core-1.1.3-py3-none-any.whl.zip` & `tmp/pice_core-1.1.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,38 +1,39 @@
-Zip file size: 35764 bytes, number of entries: 36
--rw-rw-rw-  2.0 fat      358 b- defN 23-Apr-07 08:07 pice_core/__init__.py
+Zip file size: 37593 bytes, number of entries: 37
+-rw-rw-rw-  2.0 fat       96 b- defN 23-May-10 05:50 pice_core/__init__.py
 -rw-rw-rw-  2.0 fat     1154 b- defN 23-Apr-04 06:16 pice_core/global_variables_for_test_report.py
--rw-rw-rw-  2.0 fat     1370 b- defN 23-Mar-23 07:09 pice_core/log_handler.py
+-rw-rw-rw-  2.0 fat     1579 b- defN 23-May-10 05:50 pice_core/log_handler.py
 -rw-rw-rw-  2.0 fat      515 b- defN 23-Apr-24 07:23 pice_core/read_test_info.py
--rw-rw-rw-  2.0 fat      430 b- defN 23-Apr-25 03:28 pice_core/can_related/__init__.py
--rw-rw-rw-  2.0 fat     6602 b- defN 23-Apr-25 03:26 pice_core/can_related/can_control.py
--rw-rw-rw-  2.0 fat     6695 b- defN 23-Mar-23 06:38 pice_core/can_related/canoe_connect.py
--rw-rw-rw-  2.0 fat     6702 b- defN 23-Apr-04 06:16 pice_core/can_related/kvaser_connect.py
+-rw-rw-rw-  2.0 fat      469 b- defN 23-May-11 06:38 pice_core/can_related/__init__.py
+-rw-rw-rw-  2.0 fat     6613 b- defN 23-May-10 05:50 pice_core/can_related/can_control.py
+-rw-rw-rw-  2.0 fat     1949 b- defN 23-May-05 08:50 pice_core/can_related/canape_connect.py
+-rw-rw-rw-  2.0 fat     6712 b- defN 23-May-10 05:50 pice_core/can_related/canoe_connect.py
+-rw-rw-rw-  2.0 fat     6713 b- defN 23-May-10 05:50 pice_core/can_related/kvaser_connect.py
 -rw-rw-rw-  2.0 fat    12751 b- defN 23-Apr-13 03:05 pice_core/can_related/parse_canoe_tools.py
 -rw-rw-rw-  2.0 fat        4 b- defN 23-Mar-23 03:18 pice_core/cb_related/__init__.py
 -rw-rw-rw-  2.0 fat     8600 b- defN 23-Apr-25 05:28 pice_core/cb_related/codebeamer_connect.py
 -rw-rw-rw-  2.0 fat        4 b- defN 23-Mar-23 03:18 pice_core/config/__init__.py
 -rw-rw-rw-  2.0 fat      957 b- defN 23-Mar-22 08:00 pice_core/config/report.css
 -rw-rw-rw-  2.0 fat        4 b- defN 23-Mar-23 03:18 pice_core/dataset_handler/__init__.py
--rw-rw-rw-  2.0 fat     5922 b- defN 23-Apr-02 02:34 pice_core/dataset_handler/data_set.py
+-rw-rw-rw-  2.0 fat     5933 b- defN 23-May-10 05:50 pice_core/dataset_handler/data_set.py
 -rw-rw-rw-  2.0 fat     3345 b- defN 23-Apr-25 03:26 pice_core/instrument_control/__init__.py
 -rw-rw-rw-  2.0 fat     3654 b- defN 23-Apr-17 03:27 pice_core/instrument_control/battery_chroma_control.py
 -rw-rw-rw-  2.0 fat     2593 b- defN 23-Apr-17 03:33 pice_core/instrument_control/battery_gmc_control.py
 -rw-rw-rw-  2.0 fat     3508 b- defN 23-Apr-17 03:33 pice_core/instrument_control/battery_itech_control.py
 -rw-rw-rw-  2.0 fat     2231 b- defN 23-Apr-17 03:33 pice_core/instrument_control/battery_korad_control.py
 -rw-rw-rw-  2.0 fat     2614 b- defN 23-Apr-17 03:33 pice_core/instrument_control/battery_ngi.py
 -rw-rw-rw-  2.0 fat     5166 b- defN 23-Apr-19 01:39 pice_core/instrument_control/bin_set_module_control.py
--rw-rw-rw-  2.0 fat     2556 b- defN 23-Apr-02 02:26 pice_core/instrument_control/read_curr_vol_module_control.py
--rw-rw-rw-  2.0 fat     2609 b- defN 23-Mar-23 06:20 pice_core/instrument_control/serial_control.py
+-rw-rw-rw-  2.0 fat     2975 b- defN 23-May-06 09:31 pice_core/instrument_control/read_curr_vol_module_control.py
+-rw-rw-rw-  2.0 fat     2322 b- defN 23-May-10 05:50 pice_core/instrument_control/serial_control.py
 -rw-rw-rw-  2.0 fat        4 b- defN 23-Mar-23 03:18 pice_core/parse_config_file/__init__.py
--rw-rw-rw-  2.0 fat      972 b- defN 23-Mar-23 07:24 pice_core/parse_config_file/parse_config.py
--rw-rw-rw-  2.0 fat      860 b- defN 23-Mar-23 06:38 pice_core/parse_config_file/parse_yaml_case.py
+-rw-rw-rw-  2.0 fat     1190 b- defN 23-May-10 05:50 pice_core/parse_config_file/parse_config.py
+-rw-rw-rw-  2.0 fat      876 b- defN 23-May-10 06:25 pice_core/parse_config_file/parse_yaml_case.py
 -rw-rw-rw-  2.0 fat     1877 b- defN 23-Apr-25 02:16 pice_core/utils/__init__.py
 -rw-rw-rw-  2.0 fat        4 b- defN 23-Mar-23 03:18 pice_core/veristand_related/__init__.py
--rw-rw-rw-  2.0 fat     1939 b- defN 23-Apr-13 06:23 pice_core/veristand_related/gen_mapping.py
+-rw-rw-rw-  2.0 fat     2379 b- defN 23-May-11 07:18 pice_core/veristand_related/gen_mapping.py
 -rw-rw-rw-  2.0 fat      124 b- defN 23-Feb-28 09:18 pice_core/veristand_related/ni_connect.py
--rw-rw-rw-  2.0 fat    11008 b- defN 23-Apr-25 06:40 pice_core-1.1.3.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Apr-25 06:40 pice_core-1.1.3.dist-info/WHEEL
--rw-rw-rw-  2.0 fat      286 b- defN 23-Apr-25 06:40 pice_core-1.1.3.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat       10 b- defN 23-Apr-25 06:40 pice_core-1.1.3.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     3390 b- defN 23-Apr-25 06:40 pice_core-1.1.3.dist-info/RECORD
-36 files, 100910 bytes uncompressed, 30172 bytes compressed:  70.1%
+-rw-rw-rw-  2.0 fat    12907 b- defN 23-May-11 07:23 pice_core-1.1.4.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-May-11 07:23 pice_core-1.1.4.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat      286 b- defN 23-May-11 07:22 pice_core-1.1.4.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat       10 b- defN 23-May-11 07:22 pice_core-1.1.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     3486 b- defN 23-May-11 07:23 pice_core-1.1.4.dist-info/RECORD
+37 files, 105696 bytes uncompressed, 31847 bytes compressed:  69.9%
```

## zipnote {}

```diff
@@ -12,14 +12,17 @@
 
 Filename: pice_core/can_related/__init__.py
 Comment: 
 
 Filename: pice_core/can_related/can_control.py
 Comment: 
 
+Filename: pice_core/can_related/canape_connect.py
+Comment: 
+
 Filename: pice_core/can_related/canoe_connect.py
 Comment: 
 
 Filename: pice_core/can_related/kvaser_connect.py
 Comment: 
 
 Filename: pice_core/can_related/parse_canoe_tools.py
@@ -87,23 +90,23 @@
 
 Filename: pice_core/veristand_related/gen_mapping.py
 Comment: 
 
 Filename: pice_core/veristand_related/ni_connect.py
 Comment: 
 
-Filename: pice_core-1.1.3.dist-info/METADATA
+Filename: pice_core-1.1.4.dist-info/METADATA
 Comment: 
 
-Filename: pice_core-1.1.3.dist-info/WHEEL
+Filename: pice_core-1.1.4.dist-info/WHEEL
 Comment: 
 
-Filename: pice_core-1.1.3.dist-info/entry_points.txt
+Filename: pice_core-1.1.4.dist-info/entry_points.txt
 Comment: 
 
-Filename: pice_core-1.1.3.dist-info/top_level.txt
+Filename: pice_core-1.1.4.dist-info/top_level.txt
 Comment: 
 
-Filename: pice_core-1.1.3.dist-info/RECORD
+Filename: pice_core-1.1.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pice_core/__init__.py

```diff
@@ -1,11 +1,5 @@
-from .log_handler import LogHandler
-from .global_variables_for_test_report import g_project
 import os
 
-log_handler.log_path = os.path.abspath('.') + r"\Project\{}\test_result\test_log\log.txt".format(g_project)
-
-logger = LogHandler.get_log_handler(__name__, "info")
-
 css_path = os.path.dirname(os.path.abspath(__file__)) + r"/config/report.css"
```

## pice_core/log_handler.py

```diff
@@ -1,34 +1,34 @@
 import logging
 import os
 
-log_path = 'log.txt'
+from .global_variables_for_test_report import g_project
 
 
 class LogHandler:
 
     @staticmethod
     def get_log_handler(name, level="info"):
         log_level = LogHandler._get_log_level(level)
-        logger = logging.getLogger(name)
-        logger.setLevel(level=log_level)
+        pice_logger = logging.getLogger(name)
+        pice_logger.setLevel(level=log_level)
 
         if os.path.exists(log_path):
             # handler = RotatingFileHandler(filename=log_path, maxBytes=1024, backupCount=1)
             log_size = round(os.path.getsize(log_path) / float(1024), 2)
-            if log_size > 5.0:  # 如果文件大于5KB
+            if log_size > 10.0:  # 如果文件大于10KB
                 os.remove(log_path)
 
             handler = logging.FileHandler(filename=log_path)
             handler.setLevel(log_level)
             formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
             handler.setFormatter(formatter)
-            logger.addHandler(handler)
+            pice_logger.addHandler(handler)
 
-        return logger
+        return pice_logger
 
     @staticmethod
     def _get_log_level(level: str):
         if level == "warning":
             return logging.WARNING
         elif level == "info":
             return logging.INFO
@@ -38,8 +38,10 @@
             return logging.ERROR
         elif level == "critical":
             return logging.CRITICAL
         else:
             raise Exception("Given log level is invalid.")
 
 
+log_path = os.path.abspath('.') + r"\Project\{}\test_result\test_log\log.txt".format(g_project)
 
+logger = LogHandler.get_log_handler(__name__, "info")
```

## pice_core/can_related/__init__.py

```diff
@@ -1,9 +1,10 @@
 from ..parse_config_file import parse_config
 from .can_control import Msg
+from .kvaser_connect import KvaserMsg
 from ..instrument_control import default_config
 
 
 def connect_can_control_by_vector_hardware(config: parse_config.ConfigHandler = default_config, can_fd=True):
     serial = config.get_config_by_name('vector_hardware')['serial_number']
     channel = config.get_config_by_name('vector_hardware')['channel']
```

## pice_core/can_related/can_control.py

```diff
@@ -6,15 +6,15 @@
 """
 
 import can
 import math
 import sys
 import time
 
-from .. import logger
+from ..log_handler import logger
 
 
 FC = [0x30]
 
 
 class Msg:
     def __init__(self, serial, channel, can_fd=True):
```

## pice_core/can_related/canoe_connect.py

```diff
@@ -8,15 +8,15 @@
  - choose a specific CANoe project before running this script.
 """
 
 import time
 from win32com.client import *
 import sys
 
-from .. import logger
+from ..log_handler import logger
 
 
 class CanoeSync(object):
     def __init__(self):
         app = DispatchEx('CANoe.Application')
         app.Configuration.Modified = False
         self.App = app
@@ -158,15 +158,15 @@
         except BaseException as err:
             print("No CDD_Name or Network_Name set! \n", err)
             logger.error("No CDD_Name or Network_Name set! \n{}".format(err))
             sys.exit()
             # raise Exception("No CDD_Name or Network_Name set! \n", err)
 
         if para is not None:
-            if (type(para) is str) and (type(para_value) is int):
+            if (type(para) is str) and (type(para_value) is int or list):
                 req.SetParameter(para, para_value)
             elif (type(para) is list) and (type(para_value) is list):
                 for i in range(len(para_value)):
                     req.SetParameter(para[i], para_value[i])
             else:
                 raise Exception("Inconsistent types of {} and {}!".format(para, para_value))
 
@@ -175,12 +175,12 @@
             time.sleep(0.2)
 
         count = req.Responses.count
         if count == 0:
             print("{}: No Response received!".format(req_name))
         else:
             resp = req.Responses(count)
-            if req.Responses(1).Positive:  # 判断是否为肯定响应
-                stream = resp.Stream.tolist()
-                return stream
-            else:
-                raise Exception("DID {} get a negative response".format(req_name))
+            # if req.Responses(1).Positive:  # 判断是否为肯定响应
+            stream = resp.Stream.tolist()
+            return stream
+            # else:
+            #     raise Exception("DID {} get a negative response".format(req_name))
```

## pice_core/can_related/kvaser_connect.py

```diff
@@ -7,15 +7,15 @@
 """
 
 import can
 
 import math
 import sys
 
-from .. import logger
+from ..log_handler import logger
 
 FC = [0x30]
 
 
 class KvaserMsg:
     def __init__(self, can_fd=True):
         """
```

## pice_core/dataset_handler/data_set.py

```diff
@@ -19,15 +19,15 @@
 @Date: 2022.11.26
 """
 import sys
 import enum
 
 import openpyxl
 
-from .. import logger
+from ..log_handler import logger
 
 
 class DatasetHandler:
     def __init__(self, path: str, used_sheet: enum):
         self.__excel_data = self._get_excel_data(path, used_sheet)
 
     @staticmethod
```

## pice_core/instrument_control/read_curr_vol_module_control.py

```diff
@@ -4,26 +4,25 @@
 Refer to KV_AMPxxx系列微电流表头-用户手册V1.0.pdf and KV_DVMxxx系列电压表头-用户手册V1.1.pdf
 for the relevant calculation formulae.
 
 @Author: Siwei.Lu
 @Date: 2022.11.27
 """
 import sys
-
 import time
 
-from ..parse_config_file import parse_config
 from . import serial_control
 
 
 class ReadCurrVolModuleControl:
     def __init__(self, baud, com):
         self.__baud = baud
         self.__com = com
         self.__read_req = [0x01, 0x03, 0x00, 0x00, 0x00, 0x02]
+        self.__modify_addr = [0x01, 0x06, 0x00, 0x04, 0x00, 0x02]
 
         try:
             self.__serialHandler = serial_control.SerialHandler(self.__com, self.__baud)
         except BaseException as err:
             print("read_current_voltage_module({}) open failed! \n{}".format(self.__com, err))
             serial_control.logger.error("read_current_voltage_module({}) open failed! \n{}".format(self.__com, err))
             sys.exit()
@@ -49,22 +48,36 @@
 
         if (voltage[3] == 0xFF) and (voltage[4] == 0xFF):
             return -round((0xFFFF - voltage[5] * 0x100 - voltage[6]) * Resolution * Resolution * 0.001, 3)  # mV 转 V
 
         return round((voltage[5] * 0x100 + voltage[6]), 3) * Resolution * 0.001  # mV 转 V
 
     def _send_and_rec(self, request_cmd: list):
-        for i in range(2):  # 发2次命令，避免接收数据不对
-            cmd = request_cmd.copy()
-            self.__serialHandler.send_req(self.__serialHandler.get_array_after_crc16(cmd))
-            data = self.__serialHandler.rec_data()
-            time.sleep(0.5)
-
-        while True:
-            if len(data) == 9:  # 判断接收数据长度是否为指定长度
-                break
-            else:
-                cmd = request_cmd.copy()
-                self.__serialHandler.send_req(self.__serialHandler.get_array_after_crc16(cmd))
-                data = self.__serialHandler.rec_data()
+        cmd = request_cmd.copy()
+        self.__serialHandler.send_req(self.__serialHandler.get_array_after_crc16(cmd))
+        data = self.__serialHandler.rec_data()
+
+        if not data:
+            raise RuntimeWarning(
+                f"Serial port ({self.__com}) timeout: Empty response received for address {request_cmd[0]}")
 
         return data
+
+    def change_device_address(self, current_address, new_address):
+        cmd = self.__modify_addr.copy()
+        cmd[0] = current_address
+        cmd[5] = new_address
+
+        self.__serialHandler.send_req(self.__serialHandler.get_array_after_crc16(cmd))
+
+        time.sleep(1)
+
+    def check_device_address(self, start_range: int = 1, end_range: int = None):
+        if not end_range:
+            end_range = 32
+
+        for addr in range(start_range, end_range + 1):
+            try:
+                self.read_current(addr)
+                print(f"KV_AMP {addr} is exit")
+            except RuntimeWarning:
+                print(f"KV_AMP {addr} is not exit")
```

## pice_core/instrument_control/serial_control.py

```diff
@@ -5,53 +5,43 @@
 @Date: 2022.11.27
 """
 
 import time
 import numpy as np
 import serial
 
-from ..log_handler import LogHandler
-
-logger = LogHandler.get_log_handler(__name__, "info")
+from ..log_handler import logger
 
 
 class SerialHandler:
     def __init__(self, com, baud):
         """设定COM口和波特率"""
-        self.com = serial.Serial(com, baud)
+        try:
+            self.com = serial.Serial(com, baud, timeout=1)
+        except BaseException as err:
+            print("Serial Port Open failed! \n{}".format(err))
+            logger.critical("Serial Port Open failed! \n{}".format(err))
 
     def send_req(self, command):
         """
         Send given command
         :param command: str or list
         :return:
         """
-        # print("type = ", type(command), command)
-
         if type(command) == str:
             command_data = np.fromstring(command, dtype=np.uint8)
         else:
             command_data = command
 
         self.com.write(command_data)
 
-    def rec_data(self):
-        flag = 0
-        while True:
-            count = self.com.inWaiting()  # 缓冲区字节长度
-            flag = flag + 1
-            # print("count = {}".format(count))
-            if count > 0:
-                time.sleep(0.3)
-                data = self.com.read(count)  # 读取缓冲区字节
-                break
-            elif flag == 30000:
-                raise RuntimeWarning("Serial port ({}) timeout".format(self.com.port))
+        time.sleep(0.5)
 
-        return data
+    def rec_data(self):
+        return self.com.read(self.com.inWaiting())  # 读取缓冲区字节
 
     @staticmethod
     def _crc16_calc(list_data: list):
         """CRC计算"""
         crc16 = 0xFFFF
         poly = 0xA001
         for i in range(0, len(list_data)):
```

## pice_core/parse_config_file/parse_config.py

```diff
@@ -2,25 +2,30 @@
 This file is used to parse yaml files and provides some methods.
 
 @Author: Siwei.Lu
 @Date: 2022.11.27
 """
 
 import yaml
+from ..log_handler import logger
 
 
 class ConfigHandler:
     def __init__(self, path):
         """处理配置文件 config.yaml : Absolute Path"""
         self.__config_data = self._parse_config_data(path)
 
     @staticmethod
     def _parse_config_data(path):
-        with open(path, 'r', encoding='UTF-8') as config:
-            return yaml.load(config, Loader=yaml.FullLoader)
+        try:
+            with open(path, 'r', encoding='UTF-8') as config:
+                return yaml.load(config, Loader=yaml.FullLoader)
+        except BaseException as err:
+            print("Read yaml failed! \n{}".format(err))
+            logger.critical("Read yaml failed! \n{}".format(err))
 
     def get_config_by_inst(self, inst_type: str):
         return self.__config_data['instrument'][inst_type]
 
     def get_config_by_name(self, name: str):
         return self.__config_data[name]
```

## pice_core/parse_config_file/parse_yaml_case.py

```diff
@@ -2,28 +2,27 @@
 This file is used to parse yaml files of test case.
 
 @Author: Siwei.Lu
 @Date: 2022.12.6
 """
 
 import yaml
-
-from .. import logger
+from ..log_handler import logger
 
 
 class YamlCaseHandler:
-    def __init__(self, path=r'\test_profile\test_case\tc_bin.yaml'):
+    def __init__(self, path: str = r'\test_profile\test_case\tc_bin.yaml'):
         """处理配置文件"""
         self.__path = path
 
         try:
             self.__tc_data = self._parse_tc_data(self.__path)
         except BaseException as err:
-            print("Read Yaml case failed! \n{}".format(err))
-            logger.critical("Read Yaml case failed!\n{}".format(err))
+            print("Read Case Yaml failed! \n{}".format(err))
+            logger.critical("Read Case Yaml failed!\n{}".format(err))
 
     @staticmethod
     def _parse_tc_data(path):
         with open(path, 'r', encoding='UTF-8') as config:
             return yaml.load(config, Loader=yaml.FullLoader)
 
     def get_tc_data(self):
```

## pice_core/veristand_related/gen_mapping.py

```diff
@@ -23,16 +23,16 @@
         lines = f.readlines()
         data = ['from niveristand.clientapi import ChannelReference\r\n']
         for line in lines:
             # 根据条件修改
             if '=' not in line:  # 只修改一次，如果已经修改过则不需要修改
                 last_file = line.split('/')[-1]
                 sec_file = line.split('/')[-2]
-                sec_file = sec_file.replace(" ", "").replace(".", "_").replace("-", "_").replace('(', '_').replace(')', '')
-                temp = last_file.replace(" ", "").replace(".", "_").replace("-", "_").replace('(', '_').replace(')', '')
+                sec_file = replace_abnormal_char(sec_file)
+                temp = replace_abnormal_char(last_file)
                 temp = temp.strip()  # 默认删除两头的空白符（包括'\n', '\r', '\t', ' '）
 
                 line = temp + " = " + 'ChannelReference("' + line.rstrip() + '")\n'
                 # i=i.replace('abc','def')   #修改abc为def
 
             if temp not in para_list:
                 para_list.append(temp)
@@ -42,7 +42,23 @@
 
     # write
     # generate_path = 'DCC111_channel_definition.py'  # 生成通道变量名称
     generate_path = r'{}\test_files\ni_mapping_def.py'.format(project_name)
     with open(generate_path, "w") as f:
         for line in data:
             f.writelines(line)
+
+
+def replace_abnormal_char(input_char: str):
+    abnormal_char_list_to_null = [" ", ")"]
+    abnormal_char_list_to_dash = ["*", "-", "=", "<", ">",
+                                  "[", "]", "+", "&",
+                                  "%", "(", ",", ".",
+                                  ":", "。", ";", "~", "∈"]
+
+    for character in abnormal_char_list_to_null:
+        input_char = input_char.replace(character, "")
+
+    for character in abnormal_char_list_to_dash:
+        input_char = input_char.replace(character, "_")
+
+    return input_char
```

## Comparing `pice_core-1.1.3.dist-info/METADATA` & `pice_core-1.1.4.dist-info/METADATA`

 * *Files 15% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pice-core
-Version: 1.1.3
+Version: 1.1.4
 Summary: this is a program for pice_core
 Author: siwei.lu
 Author-email: siwei.lu@keboda.com
 Description-Content-Type: text/markdown
 Requires-Dist: cantools (==38.0.2)
 Requires-Dist: nidaqmx (==0.7.0)
 Requires-Dist: numpy (==1.24.2)
@@ -39,37 +39,46 @@
 
 ### 2. 安装
 
 ```sh
 pip install pice-core
 ```
 
+```sh
+pip install --upgrade pice-core
+```
+
 ### 3. 连接测试工具
 
 #### 3.1 连接canoe工程
 **请确认是否打开需要用到的canoe工程**
 
 ```python
 from pice_core.can_related import canoe_connect
 
 canoe_app = canoe_connect.CanoeSync() # 实例化
 
+# canoe_app.start_measurement()  # 运行CANoe工程
+
 # 环境变量
 canoe_app.set_EnvVar("SideMarker_Actv_Rq_1", 0x01)   #设置环境变量值
 SideMarker = canoe_app.get_EnvVar("SideMarker_Actv_Rq_1")   #读取环境变量值
 print(SideMarker)
 
 # 诊断命令
 canoe_app.cdd_name = "cdd_name"  # 配置CDD名字：一定要配置，不然发不了诊断报文
+# canoe_app.network_name = "CAN1"  # 该参数为节点的名字: 在simulation setup里查看(默认为"CAN")
 did_result1 = canoe_app.send_diag_req("FD08_DID")  # 读写DID：DID无参数
 print(did_result1)
 
 did_result2 = canoe_app.send_diag_req("Method_2_Data_Type_1_Write",["PWM1_Function_Assign_cfg", "PWM2_Function_Assign_cfg"], [1,1])  # 读写DID：DID有参数
 print(did_result2)
 
+# canoe_app.stop_measurement()   # 停止CANoe工程
+
 ```
 
 #### 3.2 连接电源
 **请确认是否连接电源，以及相关的串口信息**
 
 可选电源包括：
 - Itech
@@ -116,18 +125,18 @@
 # 如果电源是使用串口控制，请修改以下参数
 baud = 115200  # 电源波特率
 com = "com3"  # 电源com口
 
 # 如果电源是使用visa控制，请修改以下参数 (在NI MAX中查看)
 visa_resource = "USB0::0xFFFF::0x6500::800264020737720001::INSTR"
 
-battert_chroma = battery_chroma_control.BatChromaControlByVisa(resource=visa_resource)  # 实例化
-battert_chroma.set_input_voltage(13)  # 设置输入电压
-battert_chroma.set_input_current(20)  # 设置输入电流
-battert_chroma.set_output("on")  # 设置输出模式 on/off
+battery_chroma = battery_chroma_control.BatChromaControlByVisa(resource=visa_resource)  # 实例化
+battery_chroma.set_input_voltage(13)  # 设置输入电压
+battery_chroma.set_input_current(20)  # 设置输入电流
+battery_chroma.set_output("on")  # 设置输出模式 on/off
 
 battery_gmc = battery_gmc_control.BatGMCControlBySerial(baud=baud, com=com)  # 实例化
 battery_gmc.set_input_voltage(13)  # 设置输入电压
 battery_gmc.set_input_current(20)  # 设置输入电流
 battery_gmc.set_output("on")  # 设置输出模式 on/off
 
 ```
@@ -148,26 +157,39 @@
 # 如果config.yaml文件的路径不在固定路径下
 path_yaml = "" # config.yaml路径
 config = parse_config.ConfigHandler(path_yaml)
 
 read_curr_vol = set_curr_vol_module(config) # 实例化
 read_curr_vol.read_voltage(1) # 读地址1 电压
 read_curr_vol.read_current(13)  # 读地址13 电流
+
+# 修改地址
+read_curr_vol.change_device_address(current_address=1, new_address=10) # 把地址1的模块修改成地址10
+
+# 检测地址
+read_curr_vol.check_device_address()  # 默认检测地址 1~32 的模块是否存在
+read_curr_vol.check_device_address(5, 10) # 检测地址 5~10 的模块是否存在
 ```
 ##### 3.3.2 方法2：不依赖config.yaml
 ```python
 from pice_core.instrument_control import read_curr_vol_module_control
 
 baud = 9600 # 波特率
 com = "com3"  # com口
 
 read_curr_vol = read_curr_vol_module_control.ReadCurrVolModuleControl(baud=baud, com=com) # 实例化
 read_curr_vol.read_voltage(1) # 读地址1 电压
 read_curr_vol.read_current(13)  # 读地址13 电流
 
+# 修改地址
+read_curr_vol.change_device_address(current_address=1, new_address=10) # 把地址1的模块修改成地址10
+
+# 检测地址
+read_curr_vol.check_device_address()  # 默认检测地址 1~32 的模块是否存在
+read_curr_vol.check_device_address(5, 10) # 检测地址 5~10 的模块是否存在
 ```
 
 #### 3.4 连接24路-电流-电压输出模块
 **请确认是否连接24路-电流-电压输出模块，以及相关的串口信息**
 
 ##### 3.4.1 方法1：依赖config.yaml
 ```python
@@ -248,18 +270,18 @@
 4. 输入账号和密码
 5. xxx(功能)_testcase.py将生成在./Project/xxx（项目名）/test_profile/test_case路径下
 
 
 ### 5. 调用logger
 
 ```python
-from pice_core import logger
+from pice_core.log_handler import logger
 
 logger.debug("This is a debug log")  # 详细的信息
-logger.info("This is a info log")  # 确认是否按照预期执行
+logger.info("This is an info log")  # 确认是否按照预期执行
 logger.warning("This is a warning log")  # 发生了非预期的事情，但是软件可以继续运行
 logger.error("This is an error log")  # 出现了一个导致软件无法执行某些功能的错误
 logger.critical("This is a critical log") # 一个严重的错误导致程序本身可能无法继续运行
 ```
 
 ### 6. 通过vector硬件控制CAN通信
 
@@ -275,34 +297,58 @@
 path_yaml = "" # config.yaml路径
 config = parse_config.ConfigHandler(path_yaml)
 can_msg = connect_can_control_by_vector_hardware(config) # 实例化
 
 # 发送报文
 msg_send_id = 0x6f6 
 msg_recv_id = 0x6fe
+# can_msg.is_extended_id = True  # 扩展帧 can_msg.is_extended_id = True， 标准帧： can_msg.is_extended_id = False (默认为标准帧)
+# can_msg.dlc = 32  # 修改DLC(默认为8)
 can_msg.send_msg(msg_send_id, [0x02, 0x10, 0x03])  # 用ID 0x6f6发送报文[0x02, 0x10, 0x03]
 
 # 获取DID的response
 can_msg.diag_send_msg_id = 0x74E  # 设置诊断报文ID
 can_msg.diag_rec_msg_id = 0x7CE  # 设置诊断报文ID
 did_list = [0x22, 0xFD, 0X11] # 读DID FD11
 did_resp = can_msg.get_did_resp(did_list)
 print(did_resp)
+
 ```
 ##### 6.2 方法2：不依赖config.yaml
 ```python
 from pice_core.can_related import Msg
 
-serial = 11035  # vector hardware serial number
+serial = 11035  # vector hardware serial number, 如果该参数前面有0,请去掉. 如：011035 应写成 serial = 11035
 channel = 1  # channel 
 
 can_msg = Msg(serial=serial, channel=channel)  # 如果使用CAN： can_fd=False
 ```
 
-### 7. 中文报告
+### 7. 连接CANape工程
+  
+目前只支持使用XCP协议
+
+```python
+from pice_core.can_related.canape_connect import CanapeSync
+import time 
+
+project_path = r"D:\001_Ford\03_CANoe simulation\XCP\Fnv3"  # XCP工程路径，该路径包含.cna和.A2L文件
+a2l_name = "LDM" # A2L文件名
+
+canape = CanapeSync(project_path=project_path, a2l_name=a2l_name)
+
+xcp_parameter = "CtApSwcMLCPixelLogic_DW.gu16_M3_HLT_AnJmpExcptRampingTime_Get"  # 参数名和A2L文件里一致
+
+for i in range(4):
+    canape.write_parameter(xcp_parameter, 200*i)   # 修改参数值(请先确认该参数是否可修改)
+    print(canape.read_parameter(xcp_parameter))    # 读取参数值
+    time.sleep(2)
+```
+
+### 8. 中文报告
 
 如果测试脚本中包含中文，请修改html_report.py(该文件在pytest_html包下)：
 
 原语句：
 ```python
 head = html.head(html.meta(charset="UTF-8"), html.title(self.title), html_css)
 ```
```

## Comparing `pice_core-1.1.3.dist-info/RECORD` & `pice_core-1.1.4.dist-info/RECORD`

 * *Files 22% similar despite different names*

```diff
@@ -1,36 +1,37 @@
-pice_core/__init__.py,sha256=5Yp2pNTiYFbzkgehFkkxtJR978XYB0Wt6U-LrhIWB4s,358
+pice_core/__init__.py,sha256=TOL4V174146V2Ds6CZbFdbcNbgrDfN2rJzLo2AfZICk,96
 pice_core/global_variables_for_test_report.py,sha256=1ZGHly3pFJdr2UPe92ImAv1XZTZaD9mpN0CwnFLUpaM,1154
-pice_core/log_handler.py,sha256=ao5ECD9aWmsqTezhfXqYcCwOSqva9jWPu-hg2_tAGU8,1370
+pice_core/log_handler.py,sha256=Ls7wEe7TyJ-nzolG944a4K096v47akCZhVnmkDLovjc,1579
 pice_core/read_test_info.py,sha256=119_tcT0LXjFusxQj6GGcpsK4IGjsoljV5Ik855hNEs,515
-pice_core/can_related/__init__.py,sha256=e5uD541-jtww1XBGtFOosP509PM1nMAlQNU29cOYGNA,430
-pice_core/can_related/can_control.py,sha256=BHEcel6bklxB0i_sH6-3qjKrQyYkaHtAEsbXjO0pZt4,6602
-pice_core/can_related/canoe_connect.py,sha256=FGhHGLZwSHdYJGjuegvcw0xQgstiqU9LMb_bjZQ4GmI,6695
-pice_core/can_related/kvaser_connect.py,sha256=IWMKeYLUdrF5tXIwS4T566ZOohwoXKpULU9SpKpQQBU,6702
+pice_core/can_related/__init__.py,sha256=RqnM3PsiJsvVbz820KN0L8Hxdslm5UD6OKTXaRF2HaU,469
+pice_core/can_related/can_control.py,sha256=OpXnsDG3Hh9IpRcQNibcdTb5iSepyfLKp6RfZTqBFbw,6613
+pice_core/can_related/canape_connect.py,sha256=2k1Y6qmBtwamrZ7IqrAJzRbo-kHkem2lvUPdnvhSSHs,1949
+pice_core/can_related/canoe_connect.py,sha256=Z4tqF091VAXXg1dmzJiXddUJLXgMWbW11s9p_WjOj9M,6712
+pice_core/can_related/kvaser_connect.py,sha256=sRHo1BVY5dEU1do-2UiaCZNPYRMdFbtpRNShF1R8f4s,6713
 pice_core/can_related/parse_canoe_tools.py,sha256=x8kFbhYb6hP6KPdtHVhRTZylvZCIoR3tkeGc6_bAeFg,12751
 pice_core/cb_related/__init__.py,sha256=26UWatnbm6ZIwQMuu9NNzQ0IW1ACO4Oe9caModuTpWM,4
 pice_core/cb_related/codebeamer_connect.py,sha256=4CygRoziVoAQSOZbqoGglx7ioz-EgT0xpo5js_n56Ug,8600
 pice_core/config/__init__.py,sha256=26UWatnbm6ZIwQMuu9NNzQ0IW1ACO4Oe9caModuTpWM,4
 pice_core/config/report.css,sha256=8SjYzqzixA4wWzO-fEshVxwRn-KsPgLOWA5etDC0Dj4,957
 pice_core/dataset_handler/__init__.py,sha256=26UWatnbm6ZIwQMuu9NNzQ0IW1ACO4Oe9caModuTpWM,4
-pice_core/dataset_handler/data_set.py,sha256=DcBVGSa4qtZ1JPTDZNRldj89nj9ZHZDspVvrqW3pmOE,5922
+pice_core/dataset_handler/data_set.py,sha256=f9YlwLfcPcxRzbw8rNM83pK_NcYb8LneE8efBu3I5oo,5933
 pice_core/instrument_control/__init__.py,sha256=-N4EuZq47RLWhiTfwoZiquTC0l4e_rlc0U31myYLru8,3345
 pice_core/instrument_control/battery_chroma_control.py,sha256=6nn1jJyI-X6D-su-UOrk3mCQN-u39xAu-g2M2UoRxaE,3654
 pice_core/instrument_control/battery_gmc_control.py,sha256=CeHGsc5_FvH9XkOYGczP7QJtZby6ME3-28WgRGvs9SA,2593
 pice_core/instrument_control/battery_itech_control.py,sha256=MwPJg8daQ7W6zyMCsvkT64U6hs2k9h6egRlpwbaJ3y0,3508
 pice_core/instrument_control/battery_korad_control.py,sha256=nPO0Hu4IVEVN8jxtgQqFsDiuVcmEMSB5r8J2mZYcMys,2231
 pice_core/instrument_control/battery_ngi.py,sha256=Nt41T5-SwgNCph_c4WnRa8yPOaGRxKEWNC9Fnnjjrm8,2614
 pice_core/instrument_control/bin_set_module_control.py,sha256=B_td3l9lwokqef70Yvi8gi4ZcA1K1kkOYsBS73QtQTs,5166
-pice_core/instrument_control/read_curr_vol_module_control.py,sha256=gkhxo5Hf4DD4ukrDIJvm9Z0w3l5YUhlqFEobUq-j3H4,2556
-pice_core/instrument_control/serial_control.py,sha256=3IeYJI3xZaBtLf3NAoijaLs_Rrzi-0RuCiO3IO6S7WA,2609
+pice_core/instrument_control/read_curr_vol_module_control.py,sha256=hvUMcSLgYcpClX3eLYyhfhJUtz2ka3BFfcKCEtwqAyg,2975
+pice_core/instrument_control/serial_control.py,sha256=_pn_VCVHnqpgmHCjoNI71KIf4SO85TIzotu2mS-E5RE,2322
 pice_core/parse_config_file/__init__.py,sha256=26UWatnbm6ZIwQMuu9NNzQ0IW1ACO4Oe9caModuTpWM,4
-pice_core/parse_config_file/parse_config.py,sha256=rjxjeSLazvrYp66AYGjpN8WhfqvzGExPz1QPlN2Eofw,972
-pice_core/parse_config_file/parse_yaml_case.py,sha256=PA0mmjGCvMQWOB505l-AC7bHivk9gRkTHlMwPQNzDyM,860
+pice_core/parse_config_file/parse_config.py,sha256=xzpaFKF-CNltc-lg1vAGjWj8iVg6xZC10a81drcGdiQ,1190
+pice_core/parse_config_file/parse_yaml_case.py,sha256=oR5u94-ipDp_HyvsQw-d_dOE_wFs134ooMdqUwDWN1k,876
 pice_core/utils/__init__.py,sha256=TvwQgWKGUEgKhMUWmh5IsuCp3CkWtQ7AXeiZfMN_c4c,1877
 pice_core/veristand_related/__init__.py,sha256=26UWatnbm6ZIwQMuu9NNzQ0IW1ACO4Oe9caModuTpWM,4
-pice_core/veristand_related/gen_mapping.py,sha256=G0PkvobiQ_7f_97l-hy2G01q2pZl2VIncMC3JFKegkU,1939
+pice_core/veristand_related/gen_mapping.py,sha256=-4yPVCIby_vLHQCEj2cEtKZKyoazMDpjaAPP_VIZFGE,2379
 pice_core/veristand_related/ni_connect.py,sha256=M2e-BltXBNXWkp1jY3dLzR6e58bI7REwm02QPtLc4J8,124
-pice_core-1.1.3.dist-info/METADATA,sha256=XIRQlo6ZvoOmcA3FJEbnaa3A-EbI4VUWiZi-vGLGC3Y,11008
-pice_core-1.1.3.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-pice_core-1.1.3.dist-info/entry_points.txt,sha256=4XxfvRyfgHxp7gyz2JZKsrn2ZYGYdXWzRFhi9TGMyBU,286
-pice_core-1.1.3.dist-info/top_level.txt,sha256=n-PbqsIksMjUV2lQKdkUNtq2HXYkHeLAIkoezbPPTzg,10
-pice_core-1.1.3.dist-info/RECORD,,
+pice_core-1.1.4.dist-info/METADATA,sha256=ozlQ8UNR8XGpzF99GOH25CTNJbSyHzjmAUsRi9UWzpk,12907
+pice_core-1.1.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+pice_core-1.1.4.dist-info/entry_points.txt,sha256=4XxfvRyfgHxp7gyz2JZKsrn2ZYGYdXWzRFhi9TGMyBU,286
+pice_core-1.1.4.dist-info/top_level.txt,sha256=n-PbqsIksMjUV2lQKdkUNtq2HXYkHeLAIkoezbPPTzg,10
+pice_core-1.1.4.dist-info/RECORD,,
```

